var H=Object.defineProperty,K=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var w=(e,t,o)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,b=(e,t)=>{for(var o in t||(t={}))N.call(t,o)&&w(e,o,t[o]);if(I)for(var o of I(t))O.call(t,o)&&w(e,o,t[o]);return e},C=(e,t)=>K(e,M(t));import{_ as m,u as A,o as u,c as r,a as l,p as x,b as k,r as T,w as f,v as R,d as q,F as E,e as F,t as B,n as V,i as S,f as y,g as z,h as p,j as G,T as U,k as J,l as P,m as g,q as Q,s as L}from"./index.0f924ddc.js";import{s as W,M as v,r as h,c as X}from"./Message.b3be0054.js";const Y=e=>(x("data-v-078a4ddd"),e=e(),k(),e),Z={class:"flex items-center"},ee=Y(()=>l("h1",{class:"mr-auto my-6 text-[28px] text-[#414873]"},"Vue3 Todo App",-1)),te={name:"TodoHeader",setup(e){const t=A(),o=async()=>{await W(),localStorage.removeItem("5xcampTodo"),t.push("/login")};return(a,n)=>(u(),r("div",Z,[ee,l("button",{class:"sign-out-btn",onClick:o},"\u767B\u51FA")]))}};var oe=m(te,[["__scopeId","data-v-078a4ddd"]]);const se=e=>(x("data-v-943549dc"),e=e(),k(),e),ae={class:"relative flex items-center"},de=["onKeyup"],ne=se(()=>l("i",{class:"add-btn__plus"},null,-1)),ce=[ne],le={name:"TodoAdd",emits:["addTodo"],setup(e,{emit:t}){const o=T(""),a=()=>{if(!o.value.trim())return v({type:"warn",text:"\u4F60\u9084\u6C92\u8F38\u5165\u4EE3\u8FA6\u4E8B\u9805\u554A!"});const n={content:o.value};t("addTodo",n),o.value=""};return(n,i)=>(u(),r("div",ae,[f(l("input",{type:"text",name:"todo",class:"add-input","onUpdate:modelValue":i[0]||(i[0]=s=>o.value=s),onKeyup:q(a,["enter"])},null,40,de),[[R,o.value]]),l("button",{class:"add-btn",onClick:a},ce)]))}};var ie=m(le,[["__scopeId","data-v-943549dc"]]);const ue={class:"filters"},re=["onClick"],_e={name:"TodoFilter",props:{selected:{type:String,default:"all"}},setup(e){const t=[{label:"\u5168\u90E8",value:"all"},{label:"\u5DF2\u5B8C\u6210",value:"done"},{label:"\u672A\u5B8C\u6210",value:"todo"}];return(o,a)=>(u(),r("div",ue,[(u(),r(E,null,F(t,n=>l("span",{class:V(["filter",{active:e.selected===n.value}]),key:n.value,onClick:i=>o.$emit("change-filter",n.value)},B(n.label),11,re)),64))]))}};var pe=m(_e,[["__scopeId","data-v-2d04d8d2"]]);const ve=e=>(x("data-v-ce04c386"),e=e(),k(),e),me={class:"relative flex items-center mr-auto"},Te=["checked"],he=ve(()=>l("span",{class:"todo-item__check-button"},null,-1)),ge=["value"],fe={name:"TodoListITem",props:{todoItem:{type:Object,default:()=>({})}},setup(e){const{deleteTodo:t}=S("deleteTodo"),{updateTodo:o}=S("updateTodo"),a=d=>{t(d)},n=T(null),i=d=>{d.isEdit=!0,z(()=>n.value.focus())},s=(d,c)=>{if(d.isEdit=!1,!c.target.value.trim())return v({type:"warn",text:"\u5167\u5BB9\u4E0D\u5F97\u70BA\u7A7A!"});d.content!==c.target.value&&o(d.id,c.target.value)};return(d,c)=>(u(),r("div",{class:V(["todo-item",{done:e.todoItem.completed_at}])},[l("label",me,[l("input",{class:"todo-item__checkbox",type:"checkbox",checked:e.todoItem.completed_at,onClick:c[0]||(c[0]=_=>d.$emit("change-state",_))},null,8,Te),he,f(l("span",null,B(e.todoItem.content),513),[[y,!e.todoItem.isEdit]]),f(l("input",{type:"text",value:e.todoItem.content,onBlur:c[1]||(c[1]=_=>s(e.todoItem,_)),ref_key:"inputRef",ref:n},null,40,ge),[[y,e.todoItem.isEdit]])]),f(l("i",{class:"material-icons-outlined todo-item__icon mr-2",onClick:c[2]||(c[2]=_=>i(e.todoItem))},"edit",512),[[y,!e.todoItem.isEdit]]),l("i",{class:"material-icons-outlined todo-item__icon",onClick:c[3]||(c[3]=_=>a(e.todoItem.id))},"delete")],2))}};var ye=m(fe,[["__scopeId","data-v-ce04c386"]]);const xe=()=>h("/todos","get"),ke=e=>h("/todos","post",{todo:e}),$e=e=>h(`/todos/${e}/toggle`,"patch"),Ie=(e,t)=>h(`/todos/${e}`,"put",{todo:{content:t}}),we=e=>h(`/todos/${e}`,"delete");function j(){const e=T([]);return{todos:e,addTodo:async s=>{const d=await ke(s);e.value.unshift(C(b({},d),{complete_at:null})),v({type:"success",text:"\u65B0\u589E\u6210\u529F!"})},deleteTodo:async s=>{e.value=e.value.filter(d=>d.id!==s),await we(s),v({type:"success",text:"\u522A\u9664\u6210\u529F!"})},updateTodo:async(s,d)=>{e.value.forEach(c=>{c.id===s&&(c.content=d)}),await Ie(s,d),v({type:"success",text:"\u4FEE\u6539\u6210\u529F!"})},toggleTodo:async s=>{await $e(s)},getTodoList:async()=>{const{todos:s}=await xe();e.value=s}}}const be={class:"grid gap-y-3.5"},Ce={name:"TodoList",props:{todos:{type:Array,default:()=>[]}},setup(e){const{toggleTodo:t}=j(),o=(a,n)=>{a.completed_at=n.target.checked,t(a.id)};return(a,n)=>(u(),r("div",be,[p(U,{name:"list",appear:""},{default:G(()=>[(u(!0),r(E,null,F(e.todos,i=>(u(),J(ye,{key:i.id,"todo-item":i,onChangeState:s=>o(i,s)},null,8,["todo-item","onChangeState"]))),128))]),_:1})]))}};var Se=m(Ce,[["__scopeId","data-v-281307ea"]]);function Le(e){const t=T("all"),o=P(()=>{switch(t.value){case"done":return e.value.filter(a=>a.completed_at);case"todo":return e.value.filter(a=>!a.completed_at);default:return e.value}});return{filter:t,filteredTodos:o}}function Ae(){const e=A(),t=T(!1);return{checkSuccess:t,checkLogin:async()=>{try{await X(),t.value=!0}catch{alert("\u8ACB\u5148\u767B\u5165!"),e.push("/login")}}}}const Ee={key:0,class:"w-[100vw] min-h-[100vh] flex justify-center items-center bg-violet-100"},Fe={class:"container"},He={name:"Index",setup(e){const{todos:t,addTodo:o,deleteTodo:a,updateTodo:n,getTodoList:i}=j(),{filter:s,filteredTodos:d}=Le(t),{checkSuccess:c,checkLogin:_}=Ae();return L("deleteTodo",{deleteTodo:a}),L("updateTodo",{updateTodo:n}),_(),i(),(Be,$)=>g(c)?(u(),r("main",Ee,[l("div",Fe,[p(oe),p(ie,{onAddTodo:g(o)},null,8,["onAddTodo"]),p(pe,{selected:g(s),onChangeFilter:$[0]||($[0]=D=>s.value=D)},null,8,["selected"]),p(Se,{todos:g(d)},null,8,["todos"])])])):Q("",!0)}};export{He as default};
