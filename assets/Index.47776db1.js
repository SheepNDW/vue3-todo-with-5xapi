import{_ as m,u as b,o as r,c as u,a as i,p as x,b as k,r as h,w as g,v as B,d as V,F as C,e as S,t as L,n as A,i as I,f as y,g as j,h as p,j as D,T as H,k as K,l as M,m as f,q as N,s as w}from"./index.edaf247d.js";import{s as O,M as v,r as T,c as R}from"./Message.4ffa7add.js";const q=e=>(x("data-v-078a4ddd"),e=e(),k(),e),z={class:"flex items-center"},G=q(()=>i("h1",{class:"mr-auto my-6 text-[28px] text-[#414873]"},"Vue3 Todo App",-1)),U={name:"TodoHeader",setup(e){const t=b(),o=async()=>{await O(),localStorage.removeItem("5xcampTodo"),t.push("/login")};return(a,n)=>(r(),u("div",z,[G,i("button",{class:"sign-out-btn",onClick:o},"\u767B\u51FA")]))}};var J=m(U,[["__scopeId","data-v-078a4ddd"]]);const P=e=>(x("data-v-943549dc"),e=e(),k(),e),Q={class:"relative flex items-center"},W=["onKeyup"],X=P(()=>i("i",{class:"add-btn__plus"},null,-1)),Y=[X],Z={name:"TodoAdd",emits:["addTodo"],setup(e,{emit:t}){const o=h(""),a=()=>{if(!o.value.trim())return v({type:"warn",text:"\u4F60\u9084\u6C92\u8F38\u5165\u4EE3\u8FA6\u4E8B\u9805\u554A!"});const n={content:o.value};t("addTodo",n),o.value=""};return(n,l)=>(r(),u("div",Q,[g(i("input",{type:"text",name:"todo",class:"add-input","onUpdate:modelValue":l[0]||(l[0]=s=>o.value=s),onKeyup:V(a,["enter"])},null,40,W),[[B,o.value]]),i("button",{class:"add-btn",onClick:a},Y)]))}};var ee=m(Z,[["__scopeId","data-v-943549dc"]]);const te={class:"filters"},oe=["onClick"],se={name:"TodoFilter",props:{selected:{type:String,default:"all"}},setup(e){const t=[{label:"\u5168\u90E8",value:"all"},{label:"\u5DF2\u5B8C\u6210",value:"done"},{label:"\u672A\u5B8C\u6210",value:"todo"}];return(o,a)=>(r(),u("div",te,[(r(),u(C,null,S(t,n=>i("span",{class:A(["filter",{active:e.selected===n.value}]),key:n.value,onClick:l=>o.$emit("change-filter",n.value)},L(n.label),11,oe)),64))]))}};var ae=m(se,[["__scopeId","data-v-2d04d8d2"]]);const ne=e=>(x("data-v-ce04c386"),e=e(),k(),e),de={class:"relative flex items-center mr-auto"},ce=["checked"],le=ne(()=>i("span",{class:"todo-item__check-button"},null,-1)),ie=["value"],re={name:"TodoListITem",props:{todoItem:{type:Object,default:()=>({})}},setup(e){const{deleteTodo:t}=I("deleteTodo"),{updateTodo:o}=I("updateTodo"),a=c=>{t(c)},n=h(null),l=c=>{c.isEdit=!0,j(()=>n.value.focus())},s=(c,d)=>{if(c.isEdit=!1,!d.target.value.trim())return v({type:"warn",text:"\u5167\u5BB9\u4E0D\u5F97\u70BA\u7A7A!"});c.content!==d.target.value&&o(c.id,d.target.value)};return(c,d)=>(r(),u("div",{class:A(["todo-item",{done:e.todoItem.completed_at}])},[i("label",de,[i("input",{class:"todo-item__checkbox",type:"checkbox",checked:e.todoItem.completed_at,onClick:d[0]||(d[0]=_=>c.$emit("change-state",_))},null,8,ce),le,g(i("span",null,L(e.todoItem.content),513),[[y,!e.todoItem.isEdit]]),g(i("input",{type:"text",value:e.todoItem.content,onBlur:d[1]||(d[1]=_=>s(e.todoItem,_)),ref_key:"inputRef",ref:n},null,40,ie),[[y,e.todoItem.isEdit]])]),g(i("i",{class:"material-icons-outlined todo-item__icon mr-2",onClick:d[2]||(d[2]=_=>l(e.todoItem))},"edit",512),[[y,!e.todoItem.isEdit]]),i("i",{class:"material-icons-outlined todo-item__icon",onClick:d[3]||(d[3]=_=>a(e.todoItem.id))},"delete")],2))}};var ue=m(re,[["__scopeId","data-v-ce04c386"]]);const _e=()=>T("/todos","get"),pe=e=>T("/todos","post",{todo:e}),ve=e=>T(`/todos/${e}/toggle`,"patch"),me=(e,t)=>T(`/todos/${e}`,"put",{todo:{content:t}}),he=e=>T(`/todos/${e}`,"delete");function E(){const e=h([]),t=async s=>{await pe(s),v({type:"success",text:"\u65B0\u589E\u6210\u529F!"}),l()},o=async s=>{e.value=e.value.filter(c=>c.id!==s),await he(s),v({type:"success",text:"\u522A\u9664\u6210\u529F!"})},a=async(s,c)=>{e.value.forEach(d=>{d.id===s&&(d.content=c)}),await me(s,c),v({type:"success",text:"\u4FEE\u6539\u6210\u529F!"})},n=async s=>{await ve(s)},l=async()=>{const{todos:s}=await _e();e.value=s};return{todos:e,addTodo:t,deleteTodo:o,updateTodo:a,toggleTodo:n,getTodoList:l}}const Te={class:"grid gap-y-3.5"},fe={name:"TodoList",props:{todos:{type:Array,default:()=>[]}},setup(e){const{toggleTodo:t}=E(),o=(a,n)=>{a.completed_at=n.target.checked,t(a.id)};return(a,n)=>(r(),u("div",Te,[p(H,{name:"list",appear:""},{default:D(()=>[(r(!0),u(C,null,S(e.todos,l=>(r(),K(ue,{key:l.id,"todo-item":l,onChangeState:s=>o(l,s)},null,8,["todo-item","onChangeState"]))),128))]),_:1})]))}};var ge=m(fe,[["__scopeId","data-v-281307ea"]]);function ye(e){const t=h("all"),o=M(()=>{switch(t.value){case"done":return e.value.filter(a=>a.completed_at);case"todo":return e.value.filter(a=>!a.completed_at);default:return e.value}});return{filter:t,filteredTodos:o}}function xe(){const e=b(),t=h(!1);return{checkSuccess:t,checkLogin:async()=>{try{await R(),t.value=!0}catch{alert("\u8ACB\u5148\u767B\u5165!"),e.push("/login")}}}}const ke={key:0,class:"w-[100vw] min-h-[100vh] flex justify-center items-center bg-violet-100"},$e={class:"container"},Ce={name:"Index",setup(e){const{todos:t,addTodo:o,deleteTodo:a,updateTodo:n,getTodoList:l}=E(),{filter:s,filteredTodos:c}=ye(t),{checkSuccess:d,checkLogin:_}=xe();return w("deleteTodo",{deleteTodo:a}),w("updateTodo",{updateTodo:n}),_(),l(),(Ie,$)=>f(d)?(r(),u("main",ke,[i("div",$e,[p(J),p(ee,{onAddTodo:f(o)},null,8,["onAddTodo"]),p(ae,{selected:f(s),onChangeFilter:$[0]||($[0]=F=>s.value=F)},null,8,["selected"]),p(ge,{todos:f(c)},null,8,["todos"])])])):N("",!0)}};export{Ce as default};
